# LuNA Language Support (VSCode Extension)

Расширение добавляет поддержку языка **LuNA** в Visual Studio Code: подсветка `.fa`, автодополнение, диагностика связки `.fa` ↔ `ucodes.cpp`, навигация и быстрые исправления.

**Поддерживаемые файлы**

* `*.fa` (LuNA)
* `ucodes.cpp` (C++ ядра, вызываемые из LuNA)

### Возможности

* Подсветка синтаксиса LuNA (`sub`, `cf`, `df`, типы, `@ { ... }`, комментарии `//`)
* Автодополнение:

  * ключевые слова LuNA
  * сниппеты `cf`, `sub`, `@ { ... }`
  * имена `sub`/`cf` фрагментов из проекта
  * алиасы импортированных C-ядер (`import c_xxx(...) as alias`)
  * сниппет `cf alias: alias();` для реализованных ядер
  * сниппет `implement c_xxx` в `ucodes.cpp` для отсутствующих реализаций
* Диагностика:

  * вызов ядра в `.fa`, которого нет в `ucodes.cpp`
  * несовпадение числа аргументов ядра
  * несовпадение типов аргументов (по упрощённому извлечению типов)
  * hint для ядер в `ucodes.cpp`, которые нигде не используются
* Навигация:

  * Go to Definition из `.fa` на `void c_xxx(...)` в `ucodes.cpp`
  * Hover: “реализовано/не найдено” и “используется/не используется”
* Quick Fix:

  * создать заглушку `extern "C" void c_xxx() { ... }` в `ucodes.cpp` по диагностике missing-kernel
* Подсказка создания `ucodes.cpp`:

  * при создании/изменении `.fa` если рядом нет `ucodes.cpp`, расширение предлагает создать шаблон

### Установка (локально)

1. Склонируйте репозиторий
2. Установите зависимости:

   * `npm install`
3. Соберите:

   * `npm run compile`
4. Запуск в режиме разработки:

   * откройте проект в VSCode
   * `Run and Debug` → “Run Extension” (см. `.vscode/launch.json`)

### Ограничения парсинга (важно)

Language Server использует **построчные регулярные выражения**, не полноценный AST:

* `import ... as ...` должен быть в одной строке
* `cf ...: kernel(a,b,c)` делит аргументы по запятым без учёта вложенных выражений
* сигнатуры C распознаются только как `void c_name(...)`
* типы параметров C определяются эвристикой (int/real/string/value)

